(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0065aa03"],{"1eea":function(e,t,a){"use strict";a("d18c")},"48f7":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("bar",{staticClass:"bar"}),a("div",{staticClass:"content"},[a("router-view")],1)],1)},s=[],r=a("5530"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("el-menu",{attrs:{"default-active":e.activeIndex,router:!0,mode:"horizontal"}},[a("el-menu-item",{attrs:{index:"1",route:"/dashboard/announcement"}},[e._v("公告公知")]),a("el-menu-item",{attrs:{index:"2",route:"/dashboard/message"}},[e._v("大众留言")]),a("el-menu-item",{attrs:{index:"3",route:"/dashboard/blog-list"}},[e._v("博文精选")]),a("el-menu-item",{staticStyle:{float:"right"}},[a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.user.username)+" "),a("el-avatar",{staticStyle:{"margin-left":"10px"},attrs:{src:e.user.avatar}})],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.userDialogVisible=!0}}},[e._v("个人中心")])],1),a("el-dropdown-item",[a("el-button",{attrs:{type:"text"},on:{click:e.logout}},[e._v("注销登录")])],1)],1)],1)],1),a("el-menu-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(t){return e.$router.push({name:"blog-edit"})}}},[e._v("写文章")])],1)],1)],1),a("el-dialog",{attrs:{fullscreen:e.fullscreen,visible:e.userDialogVisible,"custom-class":e.dialogClass,width:"80%",right:""},on:{dblclick:function(t){e.fullscreen=!0},"update:visible":function(t){e.userDialogVisible=t}}},[a("span",{attrs:{slot:"title"},slot:"title"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.fullscreen=!e.fullscreen}}},[a("svg-icon",{attrs:{"icon-class":e.fullscreen?"off-screen":"full-screen"}})],1)],1),a("user-info")],1)],1)},i=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.show=!e.show}}},[e._v(e._s(e.show?"编辑个人信息":"个人信息"))]),a("transition",{attrs:{name:"el-zoom-in-center"}},[e.show?a("div",{staticClass:"transition-box"},[a("image-uploader",{on:{upload:e.upload}}),a("el-descriptions",{attrs:{title:"用户信息",column:3}},[a("el-descriptions-item",{attrs:{label:"用户名"}},[e._v(e._s(e.getUser.username))]),a("el-descriptions-item",{attrs:{label:"手机号"}},[e._v(e._s(e.getUser.phone))]),a("el-descriptions-item",{attrs:{label:"qq号"}},[e._v(e._s(e.getUser.qq))]),a("el-descriptions-item",{attrs:{label:"微信号"}},[e._v(e._s(e.getUser.wx))]),a("el-descriptions-item",{attrs:{label:"角色"}},[a("el-tag",{attrs:{size:"small"}},[e._v("用户")])],1)],1)],1):e._e()]),a("transition",{attrs:{name:"el-zoom-in-center"}},[e.show?e._e():a("div",{staticClass:"transition-box"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("el-form-item",{attrs:{label:"手机号"}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("el-form-item",{attrs:{label:"qq"}},[a("el-input",{model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq",t)},expression:"form.qq"}})],1),a("el-form-item",{attrs:{label:"微信号"}},[a("el-input",{model:{value:e.form.wx,callback:function(t){e.$set(e.form,"wx",t)},expression:"form.wx"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"success"},on:{click:e.update}},[e._v("确定")])],1)],1)],1)])],1)},c=[],u=a("1da1"),d=(a("96cf"),a("2f62")),m=a("c24f"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{staticClass:"uploader",attrs:{accept:"image/gif,image/png,image/jpeg",action:"none","show-file-list":!1,multiple:!1,"before-upload":e.beforeUpload,"http-request":e.upload}},[e.getUser.avatar?a("img",{staticClass:"avatar",attrs:{src:e.getUser.avatar,alt:""}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)},p=[],b=a("b775"),g=a("2a11"),h={uploadImage:function(e){return Object(b["a"])({method:g["a"].POST,url:"/image/upload",headers:{"Content-Type":"multipart/form-data"},data:e})}},v={name:"index",data:function(){return{}},computed:Object(r["a"])({},Object(d["b"])({getUser:"user"})),methods:{beforeUpload:function(e){console.debug(e);var t=e.size<=1048576;return t||this.$message.warning("图片大小超过限制，最大1MB"),t},upload:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("原图属性：",e.file),n=new FormData,n.append("multipartFile",e.file),a.next=5,h.uploadImage(n);case 5:s=a.sent,console.log("图片上传成功: ",s),t.$emit("upload",s.imageUrl);case 8:case"end":return a.stop()}}),a)})))()}}},w=v,x=(a("1eea"),a("2877")),_=Object(x["a"])(w,f,p,!1,null,"9edc85c6",null),U=_.exports,O=a("6e87"),j={name:"UserInfo",components:{ImageUploader:U},data:function(){return{imageUrl:"",show:!0,user:{},form:{}}},created:function(){this.init()},methods:Object(r["a"])(Object(r["a"])({},Object(d["c"])({setUser:O["c"]})),{},{update:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m["a"].updateUserInfo(e.form);case 3:return t.next=5,m["a"].getUserInfo(e.getUser.id);case 5:a=t.sent,e.setUser(a),e.$message.success("个人信息修改成功"),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),e.$message.error("信息修改失败");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},init:function(){this.form=JSON.parse(JSON.stringify(this.getUser))},upload:function(e){var t=this;console.log(e);var a=this.getUser;m["a"].updateAvatar({id:a.id,avatar:e}).then((function(){a.avatar=e,t.setUser(a),t.$message({type:"success",message:"头像修改成功",duration:2e3})})).catch((function(){t.$message({message:"服务器繁忙，请稍后再试",duration:1e3})}))}}),computed:Object(r["a"])({},Object(d["b"])({getUser:"user"}))},k=j,$=(a("9daa"),Object(x["a"])(k,l,c,!1,null,"23820834",null)),y=$.exports,q={name:"index",components:{UserInfo:y},data:function(){return{dialogClass:{},username:"",avatar:"",icon:"el-icon-full-screen",fullscreen:!1,userDialogVisible:!1,activeIndex:"1"}},methods:{logout:function(){this.$store.dispatch("logout"),this.$router.push("/")}},computed:Object(r["a"])({},Object(d["b"])({user:"user"}))},C=q,I=(a("f1ec"),Object(x["a"])(C,o,i,!1,null,"6ae9573b",null)),S=I.exports,z={name:"index",components:{Bar:S},data:function(){return{}},computed:{key:function(){return this.$route.path}},methods:Object(r["a"])({getUserInfo:function(){var e=this;m["a"].getPrincipal().then((function(t){m["a"].getUserInfo(t.id).then((function(t){e.setUser(t)}))}))}},Object(d["c"])({setUser:O["c"]})),created:function(){this.getUserInfo()}},D=z,E=(a("f7a2"),Object(x["a"])(D,n,s,!1,null,"4d7bced2",null));t["default"]=E.exports},"7d3b":function(e,t,a){},8415:function(e,t,a){},"8fdf":function(e,t,a){},"9daa":function(e,t,a){"use strict";a("8415")},d18c:function(e,t,a){},f1ec:function(e,t,a){"use strict";a("8fdf")},f7a2:function(e,t,a){"use strict";a("7d3b")}}]);